#include <stdio.h>
#include <errno.h>

#include "../../lfapi/lfapi.h"

#define UNUSED(x) ((void)(x))

int main(int argc, char *argv[]) {

	UNUSED(argc);
	UNUSED(argv);

	struct lf_device *dev = lfapi_createHandle();

	int rc = lfapi_open(dev, 0);
	if (LFAPI_ERR(rc)) {
		printf("Error in 'lfapi_open': %d\n", rc);
		return -1;
	}

	uint32_t data;
	for (int i = 0; i < 4; i++) {
		rc = lfapi_registerRead(dev, (uint32_t)i * 4, &data);
		if (LFAPI_OK(rc)) {
			printf("Data at '%d': %08x\n", i * 4, data);
		} else {
			printf("Error in 'lfapi_registerRead': %d (%d)\n", rc, errno);
			break;
		}
	}

	rc = lfapi_close(dev);
	if (LFAPI_ERR(rc)) {
		printf("Error in 'lfapi_close': %d\n", rc);
		return -1;
	}


	dev = lfapi_destroyHandle(dev);

	return 0;
}
